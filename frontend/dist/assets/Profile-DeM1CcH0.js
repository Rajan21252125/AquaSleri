import{e as E,k as R,u as O,r as m,j as e,N as F,o as $,B as d,p as q,q as B,t as M}from"./index-CQuxnmGs.js";import{c as T,d as z}from"./index-BeyemhbW.js";const H=()=>{const{user:a}=E(s=>s.userDetail),v=R(),x=O(),[h,u]=m.useState(!1),[N,j]=m.useState(null),[g,w]=m.useState(!1),[y,i]=m.useState(!1),[D,p]=m.useState(!1),[o,c]=m.useState({email:a==null?void 0:a.email,fullName:(a==null?void 0:a.fullName)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||"",password:"",image:(a==null?void 0:a.image)||""}),b=s=>{const{name:t,value:l}=s.target;c({...o,[t]:l})},S=()=>{w(!g)},U=async s=>{var t,l;if(s.preventDefault(),i(!0),await P(),!D){try{const n=await $(o);i(!1),d.success(n.data.msg),c({fullName:a==null?void 0:a.fullName,password:"",image:a==null?void 0:a.image}),x("/")}catch(n){d.error((l=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:l.msg),i(!1)}i(!1)}},L=()=>{var s,t;try{q(),v(B()),x("/"),d.success("Logged out successfully")}catch(l){d.error((t=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:t.msg)}},I=s=>{s.preventDefault(),u(!0)},k=s=>{s.preventDefault(),u(!1);const t=s.dataTransfer.files[0];j(URL.createObjectURL(t)),c({...o,image:t})},C=s=>{s.preventDefault(),u(!1)},P=async()=>{var t,l,n;const s=new FormData;if(s.append("image",o.image),!!s)try{const r=await M(s);if(r.status!==200){p(!0);return}c({...o,image:r.data.imageUrl}),p(!1)}catch(r){if(((t=r==null?void 0:r.response)==null?void 0:t.status)===400)return;d.error((n=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:n.msg),p(!0)}},f=localStorage.getItem("typeOfUser");return e.jsxs("div",{children:[e.jsx(F,{}),e.jsxs("div",{className:"max-w-md mx-auto mt-4 p-6 bg-white rounded-lg shadow-md",children:[e.jsxs("form",{onSubmit:U,children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Image:"}),e.jsxs("div",{className:`mb-4 rounded-full h-48 w-full flex flex-col justify-center items-center cursor-pointer ${h?"bg-gray-100":""}`,onDragOver:I,onDrop:k,onDragLeave:C,children:[N?e.jsx("img",{src:N,alt:"Preview",className:"w-36 h-36 object-cover rounded-full"}):a!=null&&a.image?e.jsx("img",{src:a==null?void 0:a.image,alt:"Preview",className:"w-36 h-36 object-cover rounded-full"}):h?e.jsx("span",{children:"Drop image"}):e.jsx("span",{children:"Upload Image"}),e.jsx("input",{className:"",type:"file",id:"imageUpload",accept:"image/*",name:"image",onChange:s=>{const t=s.target.files[0];j(URL.createObjectURL(t)),c({...o,image:t})}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Email Id:"}),e.jsx("input",{className:"border rounded-md px-4 py-2 w-full",type:"text",name:"email",value:o.email,readOnly:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Full Name:"}),e.jsx("input",{className:"border rounded-md px-4 py-2 w-full",type:"text",name:"fullName",value:o.fullName,onChange:b})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Phone Number:"}),e.jsx("input",{className:"text-sm w-full px-4 mt-4 py-2 border border-solid border-gray-300 rounded",type:"tel",placeholder:"Phone Number",name:"phoneNumber",value:o.phoneNumber,onChange:b,pattern:"[0-9]{10}",inputMode:"numeric"})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Password:"}),e.jsx("input",{className:`border rounded-md px-4 py-2 w-full ${f?"cursor-not-allowed":""}`,type:g?"text":"password",disabled:!!f,name:"password",value:o.password,onChange:f?null:b}),e.jsx("span",{className:"absolute right-4 top-10 cursor-pointer text-2xl",onClick:S,children:g?e.jsx(T,{}):e.jsx(z,{})})]}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600",type:"submit",children:y?"Loading....":"Save Changes"})]}),e.jsx("div",{className:"my-2 mb-14",children:e.jsx("button",{className:"bg-red-500 text-white w-full cursor-pointer py-2 px-4 rounded-md hover:bg-red-600",onClick:L,children:"Logout"})})]})]})};export{H as default};
