import{G as C,r as h,j as e,B as n,w as H,x as L,y as S,A as V,z as M,C as D}from"./index-CQuxnmGs.js";import{S as I,M as F,A}from"./index-CDbeClKP.js";function U(s){return C({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 18.89H6.41421L15.7279 9.57629L14.3137 8.16207L5 17.4758V18.89ZM21 20.89H3V16.6474L16.435 3.21233C16.8256 2.8218 17.4587 2.8218 17.8492 3.21233L20.6777 6.04075C21.0682 6.43128 21.0682 7.06444 20.6777 7.45497L9.24264 18.89H21V20.89ZM15.7279 6.74786L17.1421 8.16207L18.5563 6.74786L17.1421 5.33365L15.7279 6.74786Z"},child:[]}]})(s)}function R(s){return C({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 11H11V17H9V11ZM13 11H15V17H13V11ZM9 4V6H15V4H9Z"},child:[]}]})(s)}function Z(s){return C({tag:"svg",attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.854 12.854c-0-0-0-0-0-0l-4.854-4.854 4.854-4.854c0-0 0-0 0-0 0.052-0.052 0.090-0.113 0.114-0.178 0.066-0.178 0.028-0.386-0.114-0.529l-2.293-2.293c-0.143-0.143-0.351-0.181-0.529-0.114-0.065 0.024-0.126 0.062-0.178 0.114 0 0-0 0-0 0l-4.854 4.854-4.854-4.854c-0-0-0-0-0-0-0.052-0.052-0.113-0.090-0.178-0.114-0.178-0.066-0.386-0.029-0.529 0.114l-2.293 2.293c-0.143 0.143-0.181 0.351-0.114 0.529 0.024 0.065 0.062 0.126 0.114 0.178 0 0 0 0 0 0l4.854 4.854-4.854 4.854c-0 0-0 0-0 0-0.052 0.052-0.090 0.113-0.114 0.178-0.066 0.178-0.029 0.386 0.114 0.529l2.293 2.293c0.143 0.143 0.351 0.181 0.529 0.114 0.065-0.024 0.126-0.062 0.178-0.114 0-0 0-0 0-0l4.854-4.854 4.854 4.854c0 0 0 0 0 0 0.052 0.052 0.113 0.090 0.178 0.114 0.178 0.066 0.386 0.029 0.529-0.114l2.293-2.293c0.143-0.143 0.181-0.351 0.114-0.529-0.024-0.065-0.062-0.126-0.114-0.178z"},child:[]}]})(s)}const k=({data:s,setToggleShow:p})=>{var x;const[r,d]=h.useState({name:"",description:"",category:[],images:[],realPrice:"",discountedPrice:""}),[b,y]=h.useState(!1),f=[{value:"Water Purifier",label:"Water Purifier"},{value:"Water Solution",label:"Water Solution"},{value:"New Arrival",label:"New Arrival"},{value:"Service",label:"Service"}],v=l=>{const t=l.map(i=>i.value);d({...r,category:t})},m=l=>{d({...r,[l.target.name]:l.target.value})},a=l=>{const{name:t,files:i}=l.target;if(t!=="images")return;const o=Array.from(i),g=["image/jpeg","image/jpg","image/png"],u=o.filter(N=>g.includes(N.type));if(u.length>5){n.error("You can only upload up to 5 images");return}else u.length<o.length&&n.warning("Only JPG, JPEG, or PNG files are allowed");const P=u.map(N=>{const E=URL.createObjectURL(N);return{file:N,url:E}});d({...r,images:[...r.images,...P.slice(0,5-r.images.length)]})};h.useEffect(()=>{s&&d({name:s==null?void 0:s.name,description:s==null?void 0:s.description,category:s==null?void 0:s.category,images:s==null?void 0:s.images,realPrice:s==null?void 0:s.realPrice,discountedPrice:s==null?void 0:s.discountedPrice})},[s]);const c=async l=>{l.preventDefault();try{y(!0);const t=r.images.filter(o=>typeof o!="string");if(t.length>0){const o=await j(t);r.images=r.images.filter(g=>typeof g=="string"),o.data.forEach(g=>{r.images.push(g)})}const i=await H(r,s==null?void 0:s._id);i.status?(n.success(i.data.msg),p(!1)):n.error(i.data.msg)}catch(t){console.log(t),n.error("Error updating product")}finally{y(!1)}},j=async l=>{const t=new FormData;l.forEach(i=>{t.append("images",i.file)});try{return(await L(t)).data}catch(i){console.error("Error uploading images:",i)}},w=async l=>{if(r.images[l].url){const o=r.images.filter((g,u)=>u!==l);d({...r,images:o});return}const t=s._id,i=r.images[l];try{const o=await S(t,i);n.success(o.data.msg),o.data.status||n.error(o.data.msg);const g=r.images.filter((u,P)=>P!==l);d({...r,images:g})}catch(o){n.error(o.response.data.msg)}};return e.jsxs("div",{className:"mx-4 md:mx-12 lg:mx-24 xl:mx-36 p-10 -top-10 border right-0 shadow-2xl absolute bg-white overflow-auto",children:[e.jsx(Z,{className:"absolute right-10 text-red-600 cursor-pointer",onClick:()=>p(!1)}),e.jsx("h1",{className:"text-3xl font-bold my-4 text-center",children:"Update Product"}),e.jsxs("form",{onSubmit:c,className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"font-semibold mb-1",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:m,placeholder:"Enter product name",className:"w-full px-3 py-2 border rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description",className:"font-semibold mb-1",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:r.description,onChange:m,className:"w-full px-3 py-2 border rounded-md h-32",placeholder:"Enter product description"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"category",className:"font-semibold mb-1",children:"Category"}),e.jsx(I,{isMulti:!0,id:"category",name:"category",options:f,value:f.filter(l=>r.category.includes(l.value)),onChange:v,className:"w-full px-3 py-2 rounded-md",placeholder:"Enter product category"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"images",className:"font-semibold mb-1",children:"Images"}),e.jsx("input",{type:"file",id:"images",name:"images",onChange:a,accept:"image/*",multiple:!0,className:"w-full px-3 py-2 border rounded-md",disabled:r.images.length===5}),e.jsx("div",{className:"flex flex-wrap",children:(x=r==null?void 0:r.images)==null?void 0:x.map((l,t)=>e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute top-3 right-3 text-red-700 cursor-pointer bg-white rounded-md",onClick:()=>w(t)}),e.jsx("img",{src:l.url?l.url:l,alt:`Preview ${t+1}`,className:"mt-2 mr-2 w-24 h-24 object-cover"},t)]},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"realPrice",className:"font-semibold mb-1",children:"Real Price"}),e.jsx("input",{type:"number",id:"realPrice",name:"realPrice",value:r.realPrice,onChange:m,className:"w-full px-3 py-2 border rounded-md",placeholder:"Enter real price of the item."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"discountedPrice",className:"font-semibold mb-1",children:"Discounted Price"}),e.jsx("input",{type:"number",id:"discountedPrice",name:"discountedPrice",value:r.discountedPrice,onChange:m,className:"w-full px-3 py-2 border rounded-md",placeholder:"Enter discounted price of the item."})]})]}),e.jsx("button",{type:"submit",className:"col-span-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",disabled:b,children:b?"Loading ....":"Update Product"})]})]})},W=()=>{const[s,p]=h.useState([]),[r,d]=h.useState(!1),[b,y]=h.useState(null);h.useEffect(()=>{(async()=>{try{const c=await M();p(c==null?void 0:c.data)}catch(c){console.error("Error fetching product list:",c)}})()},[]);const f=async a=>{console.log(a);try{const c=await D(a);console.log(c.data),c.data.status||n.error(c.data.msg),n.success(c.data.msg)}catch(c){console.error("Error deleting product:",c),n.error("Error deleting product")}},v=a=>{d(!r),y(a)},m=a=>a.length>15?a.substring(0,15)+"...":a;return e.jsxs("div",{children:[e.jsx(V,{}),e.jsxs("div",{className:"mx-4 md:mx-12 lg:mx-24 xl:mx-36 my-8",children:[e.jsx("h1",{className:"text-3xl font-bold my-4 text-center",children:"Product List"}),e.jsx("div",{className:`${r?"block":"hidden"} relative`,children:e.jsx(k,{data:b,setToggleShow:d})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-800",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Serial No"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Images"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Name"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Category"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Description"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Discounted Price"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Real Price"}),e.jsx("th",{className:"border border-gray-800 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:s&&s.map((a,c)=>{var j;return e.jsxs("tr",{className:"border-b-2",children:[e.jsx("td",{className:"px-4 py-2",children:c+1}),e.jsx("td",{className:"px-4 py-2 flex w-40 overflow-x-scroll no-scrollbar",children:(j=a==null?void 0:a.images)==null?void 0:j.map((w,x)=>e.jsx("img",{src:w,alt:`Image ${x+1}`,className:"w-28 h-16 object-cover mr-2 mb-2"},x))}),e.jsx("td",{className:"px-4 py-2",children:m(a.name)}),e.jsx("td",{className:"px-4 py-2",children:m(a.category.join(", "))}),e.jsx("td",{className:"px-4 py-2",children:m(a.description)}),e.jsx("td",{className:"px-4 py-2",children:a.discountedPrice}),e.jsx("td",{className:"px-4 py-2",children:a.realPrice}),e.jsxs("td",{className:"px-4 py-2 flex space-x-2",children:[e.jsxs("button",{className:"flex items-center justify-center px-3 py-1 bg-blue-500 text-white rounded-md",onClick:()=>v(a),children:[e.jsx(U,{className:"mr-1"}),"Update"]}),e.jsxs("button",{className:"flex items-center justify-center px-3 py-1 bg-red-500 text-white rounded-md",onClick:()=>f(a._id),children:[e.jsx(R,{className:"mr-1"}),"Delete"]})]})]},a==null?void 0:a._id)})})]})})]}),e.jsx(A,{})]})};export{W as default};
